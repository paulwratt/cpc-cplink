0000                             ; fifo_out_byte
0000                             ; 
0000                             ; Write a single byte to a FIFO
0000                             ; 
0000                             ; Entry:
0000                             ;  data     IX+127/6 - Byte to be written stored in low byte
0000                             ;  ret addr IX+125/4
0000                             ;  old IX   IX+123/2
0000                             ;  vec ptr  IX+121/0
0000                             ;  f        IX+119/8 - local var init to 0 used to return result
0000   01 81 FD               LD   bc,0xfd81   ; bc points to status register
0003   ED 78                  IN   a,(c)   ; get status flag
0005   E6 02                  AND   0x2   
0007   28 08                  JR   z,end   ; go to end if FIFO not ready
0009   0D                     DEC   c   ; point to data reg
000A   DD 7E 7E               LD   a,(IX+126)   
000D   ED 79                  OUT   (c),a   
000F   3E 01                  LD   a,0x1   ; successful write
0011                END:         
0011   DD 77 76               LD   (ix+118),a   ; write status back